---
layout: null
---
{%- assign rsvps = site.posts | where_exp: 'page', 'page.rsvp != nil and page.rsvp.value != "no"' -%}
BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
{% for page in rsvps %}
{%- assign person = site.data.people | where_exp: 'item', 'page.in_reply_to contains item.link' | first -%}
{%- assign place = site.data.places | where_exp: 'item', 'page.in_reply_to contains item.link' | first -%}
{%- assign summary = place.name | default: person.name -%}
{%- assign location = place.address | replace: ',', '\\,' | default: null -%}
BEGIN:VEVENT
SUMMARY:{{ summary }}
DESCRIPTION:Details:\n{{ page.in_reply_to }}{% if page.rsvp.date %}
DTSTART;TZID="{{ site.timezone }}":{{ page.rsvp.date | date: '%Y%m%dT%H%M%S' }}{% endif %}{% if page.rsvp.finish %}
DTEND;TZID="{{ site.timezone }}":{{ page.rsvp.finish | date: '%Y%m%dT%H%M%S' }}{% endif %}{% if location %}
LOCATION:{{ location }}{% endif %}
BEGIN:VALARM
ACTION:DISPLAY
DESCRIPTION:{{ summary }}
TRIGGER:-PT30M
END:VALARM
END:VEVENT
{% endfor %}END:VCALENDAR
