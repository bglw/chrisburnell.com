{% if page.categories contains 'note' %}
    {% capture meta_title %}{{ page.date | date: '%A, %d %B %Y' }} – {{ site.title }}{% endcapture %}
{% elsif page.title %}
    {% capture meta_title %}{{ page.title | strip_html }} – {{ site.title }}{% endcapture %}
{% else %}
    {% capture meta_title %}{{ site.title }} – {{ site.tagline | strip_html }}{% endcapture %}
{% endif %}

{% if page.lede %}
    {% assign meta_lede = page.lede | strip_html %}
{% elsif page.categories contains 'beer' %}
    {% capture meta_lede %}One of my beer reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'bookmark' %}
    {% capture meta_lede %}One of my shared bookmarks, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'book' %}
    {% capture meta_lede %}One of my book reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'like' %}
    {% capture meta_lede %}One of my liked pages, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'music' %}
    {% capture meta_lede %}One of my music album reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'note' %}
    {% capture meta_lede %}{{ page.content | markdownify | strip_html | strip_newlines | normalize_whitespace | xml_escape | replace: '\', '' | truncatewords: 20 }}{% endcapture %}
{% elsif page.categories contains 'pen' %}
    {% capture meta_lede %}One of my CodePens, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'recipe' %}
    {% capture meta_lede %}One of my recipes, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.categories contains 'talk' %}
    {% capture meta_lede %}One of my talks, {{ page.title | strip_html }}{% if page.location %}, given at {{ page.location }}{% endif %},{% endcapture %}
{% else %}
    {% assign meta_lede = site.lede | strip_html %}
{% endif %}

{% assign meta_image = '/images/avatar@4x.png' | absolute_url %}
{% if page.banner %}
    {% assign meta_image = page.banner | last | prepend: '/images/banners/' | absolute_url %}
{% elsif page.banner_mobile %}
    {% assign meta_image = page.banner_mobile | last | prepend: '/images/banners/' | absolute_url %}
{% elsif page.page_class contains 'about' %}
    {% assign meta_image = '/images/content/rachel-and-i.png' | absolute_url %}
{% endif %}

{% capture body_class %}
    {% for class in page.page_class %}
        {{ class }}
    {% endfor %}
    {% if page.category %}
        page--{{ page.category }}
    {% endif %}
    {% if page.collection %}
        page--{{ page.collection }}
    {% endif %}
    {% if site.color_scheme %}
        {{ site.color_scheme | downcase }}
    {% endif %}
{% endcapture %}
{% assign body_class_array = body_class | split: ' ' | join: '  ' %}

{% assign meta_name = site.author.name | split: ' ' %}
{% assign meta_first_name = meta_name[0] %}
{% assign meta_last_name = meta_name[1] %}

{% if page.collection == 'posts' %}
    {%- assign link = page.bookmark_of.url | default: page.bookmark_of | default: page.like_of.url | default: page.like_of | default: page.link.url | default: page.link | default: null -%}
    {%- assign link_clean = link | remove: 'http://' | remove: 'https://' | remove: 'www.' -%}
    {%- if page.categories contains 'beer' -%}
        {%- assign link_clean = page.title | append: ' on Untappd' -%}
        {%- assign untappd_url = site.urls.untappd | append: "checkin/" | append: page.slug -%}
        {%- assign syndicate_to = site.emptyArray | push: untappd_url -%}
    {%- elsif page.categories contains 'music' -%}
        {%- assign link_clean = page.title | append: ' on Spotify' -%}
    {%- endif -%}
{% endif %}
