{% if page.category == 'like' %}
    {% capture meta_title %}Liked a page on: {{ page.like_of | remove: 'http://' | remove: 'https://' | split: '/' | first }} – {{ site.title }}{% endcapture %}
{% elsif page.titlefree %}
    {% capture meta_title %}{{ page.date | date: '%A, %d %B %Y' }} – {{ site.title }}{% endcapture %}
{% elsif page.title %}
    {% capture meta_title %}{{ page.title | strip_html }} – {{ site.title }}{% endcapture %}
{% else %}
    {% capture meta_title %}{{ site.title }} – {{ site.tagline | strip_html }}{% endcapture %}
{% endif %}

{% if page.lede %}
    {% assign meta_lede = page.lede | strip_html %}
{% elsif page.category == 'beer' %}
    {% capture meta_lede %}One of my beer reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'bookmark' %}
    {% capture meta_lede %}One of my shared bookmarks, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'book' %}
    {% capture meta_lede %}One of my book reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'like' %}
    {% capture meta_lede %}One of my liked pages, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'movie' %}
    {% capture meta_lede %}One of my movie check-ins, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'music' %}
    {% capture meta_lede %}One of my music album reviews, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'note' %}
    {% capture meta_lede %}{{ page.content | markdownify | strip_html | strip_newlines | normalize_whitespace | xml_escape | replace: '\', '' | truncatewords: 20 }}{% endcapture %}
{% elsif page.category == 'pen' %}
    {% capture meta_lede %}One of my CodePens, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'podcast' %}
    {% capture meta_lede %}One of my podcast check-ins, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'recipe' %}
    {% capture meta_lede %}One of my recipes, {{ page.title | strip_html }}.{% endcapture %}
{% elsif page.category == 'talk' %}
    {% capture meta_lede %}One of my talks, {{ page.title | strip_html }}{% if page.checkin %}, given at {{ page.checkin.name | default: page.checkin }}{% endif %},{% endcapture %}
{% elsif page.category == 'tv' %}
    {% capture meta_lede %}One of my TV check-ins, {{ page.title | strip_html }}.{% endcapture %}
{% else %}
    {% assign meta_lede = site.lede | strip_html %}
{% endif %}

{% assign meta_image = site.author.avatar | absolute_url %}
{% if page.banner %}
    {% assign meta_image = page.banner | last | prepend: '/images/banners/' | absolute_url %}
{% elsif page.banner_mobile %}
    {% assign meta_image = page.banner_mobile | last | prepend: '/images/banners/' | absolute_url %}
{% elsif page.page_class contains 'about' %}
    {% assign meta_image = '/images/content/rachel-and-i.png' | absolute_url %}
{% endif %}

{% capture body_class %}
    {% for class in page.page_class %}
        {{ class }}
    {% endfor %}
    {% if page.category %}
        page--{{ page.category }}
    {% endif %}
    {% if page.collection and page.collection != 'posts' %}
        page--{{ page.collection }}
    {% endif %}
    {% if site.color_scheme %}
        {{ site.color_scheme | downcase }}
    {% endif %}
{% endcapture %}
{% assign body_class_array = body_class | split: ' ' | join: '  ' %}

{% assign meta_name = site.author.name | split: ' ' %}
{% assign meta_first_name = meta_name[0] %}
{% assign meta_last_name = meta_name[1] %}

{%- assign link = page.bookmark_of.link | default: page.bookmark_of | default: page.like_of.link | default: page.like_of | default: page.listen_of.link | default: page.listen_of | default: page.read_of.link | default: page.read_of | default: page.watch_of.link | default: page.watch_of | default: page.link | default: null -%}
{% if page.collection == 'posts' %}
    {%- assign link_clean = link | remove: 'http://' | remove: 'https://' | remove: 'www.' -%}
    {%- if page.category == 'beer' -%}
        {%- assign link_clean = page.title | append: ' on Untappd' -%}
        {%- assign untappd_url = site.urls.untappd | append: '/checkin/' | append: page.slug -%}
        {%- assign syndicate_to = site.emptyArray | push: untappd_url -%}
    {%- elsif page.category == 'music' -%}
        {%- assign link_clean = page.title | append: ' on ' -%}
        {%- if link contains 'bandcamp' -%}
            {%- assign link_clean = link_clean | append: 'Bandcamp' -%}
        {%- elsif link contains 'soundcloud' -%}
            {%- assign link_clean = link_clean | append: 'SoundCloud' -%}
        {%- elsif link contains 'spotify' -%}
            {%- assign link_clean = link_clean | append: 'Spotify' -%}
        {%- elsif link contains 'youtube' -%}
            {%- assign link_clean = link_clean | append: 'YouTube' -%}
        {%- endif -%}
    {%- endif -%}
{% endif %}
