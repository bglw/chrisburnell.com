<div class="meta">
    <time class="date  dt-published" datetime="{{ page.date | date_to_xmlschema }}">
        {% if page.category == 'beer' %}
            <span>drank on</span>
        {% elsif page.category == 'flight' %}
            <span>departed on</span>
        {% elsif page.category == 'food' %}
            <span>ate on</span>
        {% elsif page.category == 'like' %}
            <span>liked on</span>
        {% elsif page.category == 'movie' or page.category == 'tv' %}
            <span>watched on</span>
        {% elsif page.category == 'podcast' %}
            <span>listened on</span>
        {% elsif page.category == 'book' %}
            <span>started reading on</span>
        {% elsif page.h == 'review' %}
            <span>reviewed on</span>
        {% else %}
            <span>published on</span>
        {% endif %}
        <a class="u-uid  u-url" href="{{ page.url | absolute_url }}" title="Permalink: {{ page.url | absolute_url }}">
            {{ page.date | date_to_long_string }}
        </a>
    </time>
    {% if page.category == 'flight' %}
        {% if page.finish %}
            <time class="date  dt-arrived" datetime="{{ page.finish | date_to_xmlschema }}">
                <span>arrived on</span>
                <strong>{{ page.finish | date_to_long_string }}</strong>
            </time>
        {% endif %}
        {% if page.depart %}
            <div class="departure">
                <span>departed from</span>
                <strong>{{ page.depart | string_html }}</strong>
            </div>
        {% endif %}
        {% if page.arrive %}
            <div class="departure">
                <span>arrived in</span>
                <strong>{{ page.arrive | string_html }}</strong>
            </div>
        {% endif %}
    {% endif %}
    {% if page.edit_date %}
        <time class="date  dt-updated" datetime="{{ page.edit_date | date_to_xmlschema }}">
            <span>updated on</span>
            <strong>{{ page.edit_date | date_to_long_string }}</strong>
        </time>
    {% endif %}
    {% if page.release %}
        <time class="date  dt-released" datetime="{{ page.released | date_to_xmlschema }}">
            <span>released on</span>
            <strong>{{ page.release | date_to_long_string }}</strong>
        </time>
    {% endif %}
    {% if page.authors %}
        <div class="authors">
            {% if page.category == 'beer' %}
                <span>brewed by</span>
            {% elsif page.category == 'book' %}
                <span>written by</span>
            {% else %}
                <span>by</span>
            {% endif %}
            {% assign authors = page.authors | uniq %}
            {%- for author in authors -%}
                {% unless forloop.first %}, {% endunless %}
                {%- if page.authors_link and page.authors_link[1] -%}
                    <a class="h-cite" href="{{ page.authors_link[forloop.index0] }}" title="" rel="external">
                {%- elsif page.authors_link -%}
                    <a class="h-cite" href="{{ page.authors_link }}" title="" rel="external">
                {%- else -%}
                    <strong class="h-cite">
                {%- endif -%}
                {{ author | strip }}
                {%- if page.authors_link -%}
                    </a>
                {%- else -%}
                    </strong>
                {%- endif -%}
            {%- endfor -%}
        </div>
    {% endif %}
    {% assign in_reply_to = page.in_reply_to | default: page.in-reply-to | default: page.mf-in-reply-to | default: nil %}
    {% if in_reply_to %}
        <div class="in-reply-to">
            {% if page.rsvp %}
                <data class="p-rsvp" hidden>{{ page.rsvp }}</data>
                <span>responded</span> <strong>{{ page.rsvp | capitalize }}</strong> <span>to</span>
            {% else %}
                <span>in reply to</span>
            {% endif %}
            {% for reply in in_reply_to %}
                <a class="h-cite  u-in-reply-to" rel="external" href="{{ reply }}">
                {% if reply contains 'mastodon.social' %}
                    {% if reply contains '/@' %}
                        @{{ reply | split: '/@' | last | split: '/' | first }}
                    {% elsif reply contains '/users/' %}
                        @{{ reply | split: '/users/' | last | split: '/' | first }}
                    {% else %}
                        a Toot
                    {% endif %}
                {% elsif reply contains 'twitter.com' %}
                    {% if reply contains '/status/' %}
                        @{{ reply | split: '/status/' | first | split: 'twitter.com/' | last }}
                    {% else %}
                        a Tweet
                    {% endif %}
                {% elsif reply contains 'hwclondon.co.uk' %}
                    Homebrew Website Club London
                {% else %}
                    {{ reply }}
                {% endif %}
            {% endfor %}
        </div>
    {% endif %}
    {% if page.category == 'article' %}
        {% assign words = site.emptyArray %}
        {% assign open_figure_splits = content | split: '<figure class="highlight">' %}
        {% assign words = words | push: open_figure_splits[0] %}
        {% assign open_figure_splits = open_figure_splits | shift %}
        {% for open_figure_split in open_figure_splits %}
            {% assign close_figure_split = open_figure_split | split: '</figure>' | last %}
            {% assign words = words | push: close_figure_split %}
        {% endfor %}
        {% assign words = words | join: ' ' | number_of_words %}
        <div class="reading-length">
            <span>reading length</span>
            <strong>~{{ words | divided_by: 50 | round | times: 50 }} words</strong>
            {% if words < 250 %}
                <strong hidden aria-hidden="true">~1 min</strong>
            {% else %}
                <strong hidden aria-hidden="true">~{{ words | divided_by: 250 }} mins</strong>
            {% endif %}
        </div>
    {% endif %}
    {% if page.location %}
        <div class="location">
            {% if page.category == 'beer' %}
                <span>drank at</span>
            {% elsif page.category == 'talk' %}
                <span>given at</span>
            {% else %}
                <span>at</span>
            {% endif %}
            {% if page.location_url %}
                <a class="p-location" rel="external" href="{{ page.location_url }}">{{ page.location }}</a>
            {% elsif page.location_coordinates %}
                <a class="p-location" rel="external" href="http://www.openstreetmap.org/?mlat={{ location_coordinates | split: ',' | first }}&mlon={{ location_coordinates | split: ',' | last }}&zoom=12">{{ page.location }}</a>
            {% else %}
                <strong class="p-location">{{ page.location }}</strong>
            {% endif %}
        </div>
    {% endif %}
    {% if page.weather %}
        <div class="weather">
            <span>weather</span>
            <strong class="p-weather">
                {% if page.weather.summary %}
                    {{ page.weather.summary }}
                {% endif %}
                {% if page.weather.temperature %}
                    {% if page.weather.summary %}and{% endif %}
                    {{ page.weather.summary | split: '.' | first | replace: '-0', '0' | append: '°C' }}
                {% endif %}
            </strong>
        </div>
    {% endif %}
    {% if page.rating %}
        <div>
            {%- assign rating_base = page.rating | default: 0 | at_least: 0 | at_most: 5 | floor -%}
            {%- assign rating_fraction = page.rating | minus: rating_base -%}
            <span>I rate it</span>
            <data class="p-rating  rating  delta" value="{{ page.rating }}">{% for count in (1..rating_base) %}★{% endfor %}{% if rating_fraction == 0.25 %}¼{% elsif rating_fraction == 0.5 %}½{% elsif rating_fraction == 0.75 %}¾{% endif %}</data>
            <data class="p-worst" hidden>0</data>
            <data class="p-best" hidden>5</data>
        </div>
    {% endif %}
    {% if page.badges %}
        <div class="badges">
            <span>earning {{ page.badges.size }} badge{% if page.badges.size > 1 %}s{% endif %}</span>
            {% for badge in page.badges %}
                {%- if badge.name and badge.id -%}
                    {% unless forloop.first %}, {% endunless %}<a rel="external" href="{{ site.urls.untappd | append: 'badges/' | append: badge.id }}">{{ badge.name | replace: '(', '<small>(' | replace: ')', ')</small>' }}</a>
                {%- else -%}
                    {% unless forloop.first %}, {% endunless %}<strong>{{ badge.name | default: badge | replace: '(', '<small>(' | replace: ')', ')</small>' }}</strong>
                {%- endif -%}
            {% endfor %}
        </div>
    {% endif %}
    {% if page.tags.size > 0 %}
        {% assign tags_sorted = page.tags | sort %}
        <div class="tags">
            <span>tagged under</span>
            {% for tag in tags_sorted %}{% unless forloop.first %}, {% endunless %}<a class="p-category" href="/tags/#{{ tag | slugify }}" rel="tag">{% include content/capitalizer.html input=tag %}</a>{% endfor %}
        </div>
    {% endif %}
    {% if page.category == 'pen' and page.codepen_featured == true %}
        <div class="featured">
            <span>featured on</span>
            <a rel="external" href="https://codepen.io/collection/hfqlg/">the CodePen Homepage</a>
        </div>
    {% endif %}
    {% assign syndications = page.syndicate_to | default: page.syndicate-to | default: page.mf-syndicate-to | default: syndicate_to | default: nil %}
    {% if syndications or page.codepen_slug or page.speakerdeck_slug or page.vimeo_slug or page.youtube_slug %}
        <div class="syndication">
            <span>also on </span>
            {%- assign syndication_count = 0 -%}
            {% for syndication in syndications %}
                {% if syndication contains 'codepen.io' %}
                    {%- assign syndication_slug = syndication | split: '/' | last -%}
                    {% capture syndication_codepen %}<a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/pen/{{ syndication_slug }}">CodePen</a>
                                                     <small class="strong">
                                                         (<a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/details/{{ syndication_slug }}">Details</a>,
                                                         <a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/full/{{ syndication_slug }}">Full</a>)</small>{% endcapture %}
                {% elsif syndication contains 'gist.github.com' %}
                    {% capture syndication_gist %}<a class="u-syndication" rel="syndication" href="{{ syndication }}">GitHub Gist</a>{% endcapture %}
                {% elsif syndication contains 'github.com' or syndication contains 'github.io' %}
                    {% capture syndication_github %}<a class="u-syndication" rel="syndication" href="{{ syndication }}">GitHub</a>{% endcapture %}
                {% elsif syndication contains 'mastodon.social' %}
                    {% capture syndication_mastodon %}<a class="u-syndication" rel="syndication" href="{{ syndication }}">Mastodon</a>
                                                     <small class="strong">
                                                         (<a rel="external" href="{{ site.urls.mastodon | split: '@' | first }}interact/{{ syndication | split: '/' | last }}">Interact</a>)</small>{% endcapture %}
                {% elsif syndication contains 'twitter.com' %}
                    {% capture syndication_twitter %}<a class="u-syndication" rel="syndication" href="{{ syndication }}">Twitter</a>
                                                     <small class="strong">
                                                         (<a rel="external" href="https://twitter.com/intent/like?tweet_id={{ syndication | split: '/' | last }}">Like</a>,
                                                         <a rel="external" href="https://twitter.com/intent/tweet?in_reply_to={{ syndication | split: '/' | last }}">Reply</a>,
                                                         <a rel="external" href="https://twitter.com/intent/retweet?tweet_id={{ syndication | split: '/' | last }}">Retweet</a>)</small>{% endcapture %}
                {% elsif syndication contains 'untappd.com' %}
                    {% capture syndication_untappd %}<a class="u-syndication" rel="syndication" href="{{ syndication }}">Untappd</a>
                                                     <small class="strong">
                                                         (<a rel="external" href="{{ syndication }}#commentBox">Comment</a>)</small>{% endcapture %}
                {% endif %}
            {% endfor %}
            {%- if page.codepen_slug -%}
                <a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/pen/{{ page.codepen_slug }}">CodePen</a>
                <small class="strong">
                    (<a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/details/{{ page.codepen_slug }}">Details</a>,
                    <a class="u-syndication" rel="syndication" href="{{ site.urls.codepen }}/full/{{ page.codepen_slug }}">Full</a>)
                </small>
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_codepen -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_codepen }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_gist -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_gist }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_github -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_github }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_mastodon -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_mastodon }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if page.speakerdeck_slug -%}
                {% if syndication_count > 0 %}, {% endif %}
                <a class="u-syndication" rel="syndication" href="{{ page.speakerdeck_slug | prepend: '/' | prepend: site.urls.speakerdeck }}">Speaker Deck</a>
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_twitter -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_twitter }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if syndication_untappd -%}
                {% if syndication_count > 0 %}, {% endif %}
                {{ syndication_untappd }}
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if page.vimeo_slug -%}
                {% if syndication_count > 0 %}, {% endif %}
                <a class="u-syndication" rel="syndication" href="{{ page.vimeo_slug | prepend: 'https://vimeo.com/' }}">Vimeo</a>
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
            {%- if page.youtube_slug -%}
                {% if syndication_count > 0 %}, {% endif %}
                <a class="u-syndication" rel="syndication" href="{{ page.youtube_slug | prepend: 'https://www.youtube.com/watch?v=' }}">YouTube</a>
                {%- assign syndication_count = syndication_count | plus: 1 -%}
            {%- endif -%}
        </div>
    {% endif %}
    {% if page.prefix %}
        {%- assign posts_to_check = site.posts | where: 'category', page.category -%}
        {%- capture shorturl -%}
            {{ page.prefix }}
            {%- assign n = page.date | date: '%s' | divided_by: 86400 -%}
            {%- assign s = "" -%}
            {%- assign m = "0123456789ABCDEFGHJKLMNPQRSTUVWXYZ_abcdefghijkmnopqrstuvwxyz" | split: "" -%}
            {%- for i in (1..9999) -%}
                {%- assign d = n | modulo: 60 -%}
                {%- assign s = s | prepend: m[d] -%}
                {%- assign n = n | minus: d | divided_by: 60 -%}
                {%- if n <= 0 -%}
                    {%- break -%}
                {%- endif -%}
            {%- endfor -%}{{ s }}
        {%- endcapture -%}
        {%- assign page_date = page.date | date: '%Y-%m-%d' -%}
        {%- assign filtered_posts = site.emptyArray -%}
        {%- for check in posts_to_check reversed -%}
            {%- assign check_date = check.date | date: '%Y-%m-%d' -%}
            {%- if check_date == page_date -%}
                {%- assign filtered_posts = filtered_posts | push: check -%}
            {%- endif -%}
        {%- endfor -%}
        {%- for check in filtered_posts -%}
            {%- if check.title == page.title -%}
                {%- assign shorturl = shorturl | append: forloop.index -%}
                {%- break -%}
            {%- endif -%}
        {%- endfor -%}
        <div class="shorturl">
            <span>shorturl</span>
            <a rel="self" href="{{ site.shorturl | append: shorturl }}">{{ site.shorturl | remove: 'http://' | remove: 'https://' | append: shorturl }}</a>
        </div>
    {% endif %}
    <a href="https://fed.brid.gy/" hidden></a>
</div>
