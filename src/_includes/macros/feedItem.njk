{% macro feedItem(item, site) %}
    {%- set item_of = item.data.bookmark_of | default(item.data.drink_of) | default(item.data.like_of) | default(item.data.listen_of) | default(item.data.play_of) | default(item.data.read_of) | default(item.data.watch_of) -%}
    {%- set item_of_url = item_of -%}
    {%- if item_of.url -%}
        {% set item_of_url = item_of.url %}
    {%- endif -%}
    {%- set item_of_title = item_of_url -%}
    {%- if item_of.title -%}
        {% set item_of_title = item_of.title %}
    {%- endif -%}
    <item>
        <title>{{ item.data.title | default(item_of_title) | default("Untitled") | safe }}</title>
        <link>{{ site.url + item.url }}</link>
        <guid>{{ site.url + item.url }}</guid>
        <pubDate>{{ item.date | rssDateFormat }}</pubDate>
        <category>{{ item.data.category }}</category>{% if item.data.lede %}
        <description><![CDATA[
            {{ item.data.lede | striptags(true) | safe }}
        ]]></description>{% elif (item.data.category == 'bookmark' or item.data.category == 'note') and item.templateContent != '' %}
        <description><![CDATA[
            {{ item.templateContent | striptags(true) | safe }}
        ]]></description>{% else %}
        <description><![CDATA[
            {{ item.data.categoryProperPlural | default(item.data.categoryPlural) | default(item.data.category) | title }}
        ]]></description>
        {% endif %}{% if item_of_url %}
        <atom:link rel="via" href="{{ item_of_url }}" />{% endif %}{% if item.data.in_reply_to %}
        <atom:link rel="related" href="{{ item.data.in_reply_to.url | default(item.data.in_reply_to) }}" />{% endif %}
    </item>
{% endmacro %}
