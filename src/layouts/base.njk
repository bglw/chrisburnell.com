{%- set of = bookmark_of | default(drink_of) | default(like_of) | default(listen_of) | default(play_of) | default(read_of) | default(watch_of) | default(link) -%}
{%- set of_url = of -%}
{%- if of.url -%}
	{% set of_url = of.url %}
{%- endif -%}
{%- set of_title = of_url -%}
{%- if of.title -%}
	{% set of_title = of.title %}
{%- endif -%}

{%- if category and of_title -%}
	{% set meta_title %}{{ categoryProper | default(category) | title }} of “{{ title | default(of_title) | striptags(true) | safe }}”{% endset %}
{%- elif title -%}
	{% set meta_title = title | striptags(true) | safe %}
{%- elif category -%}
	{% set meta_title %}{{ categoryProper | default(category) | title }} from {{ page.date | friendlyDate }}{% endset %}
{%- else -%}
	{% set meta_title = site.tagline | striptags(true) %}
{%- endif -%}

{%- set meta_description = description | striptags(true) | default('A page on chrisburnell.com') | safe -%}
{%- set meta_image = site.url + author.avatar -%}
{%- if banner -%}
	{%- set meta_image -%}{{ site.url }}/images/built/{{ banner | replace('jpg', 'jpeg') }}{%- endset -%}
{%- elif cover -%}
	{%- set meta_image -%}{{ site.url }}/images/built/{{ cover | replace('jpg', 'jpeg') }}{%- endset -%}
{%- elif photo -%}
	{% set first_photo = photo | toArray | first %}
	{%- set meta_image -%}{{ site.url }}/images/built/{{ first_photo.url | default(first_photo) | replace('jpg', 'jpeg') }}{%- endset -%}
{%- endif -%}
{%- set canonical = site.url + page.url -%}
{%- if category and not category.title -%}
	{% set previous_post = collections[category] | arePublished | getPreviousCollectionItem(page) %}
	{% set next_post = collections[category] | arePublished | getNextCollectionItem(page) %}
{%- endif -%}
<!DOCTYPE html>
<html lang="{{ site.locale }}" class="{% if theme %}{{ theme }}  {% elseif site.theme %}{{ site.theme }}  {% endif %}no-js">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

	<title>{{ meta_title | safe }} · {{ site.title }}</title>

	<meta name="description" content="{{ meta_description }}">

	<link rel="preload" href="/fonts/heebo-black.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/proxima-nova-regular.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/proxima-nova-italic.woff2" as="font" type="font/woff2" crossorigin>
	<link rel="preload" href="/fonts/proxima-nova-semibold.woff2" as="font" type="font/woff2" crossorigin>

	{% if env.ELEVENTY_PRODUCTION %}
		<link rel="icon" href="/images/favicon.ico">
		<link rel="icon" href="/images/favicon-64.png">
		<link rel="apple-touch-icon" href="/images/favicon-180.png">
		<link rel="apple-touch-icon-precomposed" href="/images/favicon-180.png">
		<link rel="msapplication-square310x310logo" href="/images/favicon-310.png">
	{% else %}
		<link rel="icon" href="/images/favicon-bw.ico">
		<link rel="icon" href="/images/favicon-bw-64.png">
		<link rel="apple-touch-icon" href="/images/favicon-180-bw.png">
		<link rel="apple-touch-icon-precomposed" href="/images/favicon-180-bw.png">
		<link rel="msapplication-square310x310logo" href="/images/favicon-310-bw.png">
	{% endif %}

	<link rel="self" href="{{ site.url + '/feed.xml' }}">
	<link rel="alternate" type="application/rss+xml" title="Main Posts Feed" href="{{ site.url + '/feed.xml' }}">
	<link rel="alternate" type="application/rss+xml" title="Writing Feed" href="{{ site.url + '/writing.xml' }}">
	<link rel="alternate" type="application/rss+xml" title="Replies Feed" href="{{ site.url + '/replies.xml' }}">
	<link rel="alternate" type="application/rss+xml" title="RSVPs Feed" href="{{ site.url + '/rsvps.xml' }}">
	<link rel="alternate" type="application/rss+xml" title="Checkins Feed" href="{{ site.url + '/checkins.xml' }}">
	<link rel="pingback" href="https://webmention.io/{{ site.url | getHost }}/xmlrpc">
	<link rel="webmention" href="https://webmention.io/{{ site.url | getHost }}/webmention">
	<link rel="authorization_endpoint" href="{{ author.urls.authorization }}">
	<link rel="token_endpoint" href="{{ author.urls.token }}">
	<link rel="micropub" href="{{ author.urls.micropub }}">
	<link rel="microsub" href="{{ author.urls.microsub }}">
	<link rel="openid.delegate" href="{{ site.url }}" />
	<link rel="openid.server" href="{{ author.urls.openid }}" />

	<link rel="author" href="/humans.txt">
	<link rel="manifest" href="/manifest.json">

	<meta name="author" content="{{ author.name }}">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="format-detection" content="telephone=no">

	<meta name="theme-color" content="{{ palette | keyValue("raven") }}">
	<meta name="supported-color-schemes" content="light dark">

	<style>{%- include '../../css/main.css' -%}</style>
	{% if css %}
		<style>{%- include '../../css/' + css -%}</style>
	{% endif %}
	{% if speedlify[canonical] %}
		<style>{%- include '../../css/speedlify-score.css' -%}</style>
	{% endif %}

	{% if tags and tags.includes('httpstatus') %}
		<meta name="robots" content="noindex,nofollow">
	{% else %}
		<!-- The URL -->
		<link rel="canonical" href="{{ canonical }}">
		{% if previous_post %}
			<link rel="prev" href="{{ site.url + previous_post.url }}">
		{% endif %}
		{% if next_post %}
			<link rel="next" href="{{ site.url + next_post.url }}">
		{% endif %}

		<!-- OpenGraph Microdata -->
		{% if mf_root == 'review' %}
			<meta property="og:type" content="review">
		{% elif layout == 'post' %}
			<meta property="og:type" content="article">
		{% elif page.url.includes('/about') %}
			<meta property="og:type" content="profile">
		{% else %}
			<meta property="og:type" content="website">
		{% endif %}
		<meta property="og:url" content="{{ canonical }}">
		<meta property="og:title" content="{{ meta_title }}">
		<meta property="og:description" content="{{ meta_description }}">
		<meta property="og:locale" content="{{ site.locale }}">
		<meta property="og:site_name" content="{{ site.title }}">
		<meta property="og:image" content="{{ meta_image }}">

		<!-- Twitter Microdata -->
		<meta name="twitter:card" content="summary">
		<meta name="twitter:creator" content="@{{ author.twitter }}">
		<meta name="twitter:title" content="{{ meta_title }}">
		<meta name="twitter:description" content="{{ meta_description }}">
		<meta name="twitter:image" content="{{ meta_image }}">
		<meta name="twitter:domain" content="{{ site.url | getHost }}">
		{% if twitter %}
			<meta name="twitter:widgets:theme" content="light">
			<meta name="twitter:widgets:link-color" content="{{ palette | keyValue("raven") }}">
			<meta name="twitter:widgets:border-color" content="{{ palette | keyValue("raven") }}">
		{% endif %}

		{% if layout == 'post' %}
			<meta property="article:published_time" content="{{ page.date | friendlyDate }}">
			{% if updated or finish %}
				<meta property="article:modified_time" content="{{ updated | default(finish) | friendlyDate }}">
			{% endif %}
			<meta property="article:author" content="{{ author.name }}">
			{% for tag in tags | categoryFilter | tagFilter %}
				<meta property="article:tag" content="{{ tag }}">
			{% endfor %}
		{% elif page_about %}
			<meta property="profile:first_name" content="{{ author.firstname }}">
			<meta property="profile:last_name" content="{{ author.lastname }}">
			<meta property="profile:username" content="{{ author.shortname }}">
		{% endif %}

		{% if env.ELEVENTY_PRODUCTION and site.monetization and monetization != false %}
			<meta name="monetization" content="{{ site.monetization }}">
		{% endif %}
	{% endif %}

	<script>document.documentElement.classList.remove("no-js");</script>

	{% if category == 'code' or codepen %}
		<link rel="preconnect" href="https://codepen.io">
		<link rel="preconnect" href="https://assets.codepen.io">
		<link rel="preconnect" href="https://s.codepen.io">
	{% endif %}
	{% if speakerdeck %}
		<link rel="preconnect" href="https://speakerdeck.com">
	{% endif %}
</head>
<body>
	<a href="#content" class=" [ hidden ] ">Skip to main content</a>

	<header class=" [ header ] ">
		<div class=" [ wrap  wrap--large ] ">
			<a rel="home" class=" [ logo ] " href="/" title="{{ site.title }}">
				<svg class=" [ icon icon--raven ] " aria-hidden="true" focusable="false">
					<use href="/images/sprites.svg#svg--raven"></use>
				</svg>
			</a>
			<nav class=" [ navigation ] " aria-label="Website">
				<ol class=" [ navigation__list ] ">
					{% for link in navigation %}
						{% if link.primary %}
							<li>
								<a href="{{ link.url }}"{% if page.url == link.url %} aria-current="page"{% endif %}>{{ link.title }}</a>
							</li>
						{% endif %}
					{% endfor %}
				</ol>
			</nav>
		</div>
	</header>

	<main class=" [ main ] ">
		{{ content | safe }}
	</main>

	<footer class=" [ footer ] ">
		<div class=" [ wrap ] ">
			{% include 'author.njk' %}
			<ol class=" [ footer__navigation ] ">
				{%- for link in navigation -%}
					{%- if link.secondary -%}
						<li><a href="{{ link.url }}"{% if page.url == link.url %} aria-current="page"{% endif %}>{{ link.title }}</a></li>
					{%- endif -%}
				{%- endfor -%}<li><button id="color-scheme-toggle" class=" [ anchor ] [ requires-js  js-color-scheme-toggle ] "><span class=" [ js-color-scheme-status ] ">Enable dark mode</span></button></li>
			</ol>
			<ol class=" [ footer__navigation ] ">
				<li>
					<a id="copyright" rel="license" href="/license/">© {{ site.established }}–{{ global.now | friendlyDate("yyyy") }} <span class=" [ canada ] ">{{ author.name }}</span></a>
				</li>
				{%- for item in socials -%}
					{%- if not item.hidden -%}
						<li {% if not item.primary %} hidden{% endif %}>
							{%- if item.url -%}
								<a{% if not item.primary %} tabindex="-1"{% endif %}{% if item.mf_property %} class=" [ p-{{ item.mf_property }} ] "{% endif %} href="{{ item.url }}" rel="me">{{ item.title }}</a>
							{%- else -%}
								<data{% if item.mf_property %} class=" [ p-{{ item.mf_property }} ] "{% endif %} value="{{ item.value }}" rel="me">{{ item.title }}</data>
							{%- endif -%}
						</li>
					{%- endif -%}
				{%- endfor -%}
			</ol>
			{% if speedlify[canonical] %}
				<p>
					<a class="speedlify-anchor" href="{{ author.urls.speedlify }}/{{ site.url | getHost }}/#site-{{ speedlify[canonical].hash }}">
						<speedlify-score hash="{{ speedlify[canonical].hash }}" speedlify-url="{{ author.urls.speedlify }}" score weight requests></speedlify-score>
					</a>
				</p>
			{% endif %}
		</div>
	</footer>

	<div class=" [ notification ] " hidden aria-hidden="true"></div>

	{% if tags and tags.includes('httpstatus') %}
		<script defer src="/js/simple.js?{{ pkg.version }}"></script>
	{% else %}
		<script defer src="/js/main{% if not env.ELEVENTY_PRODUCTION %}-dev{% endif %}.js?{{ pkg.version }}"></script>
	{% endif %}
	{% if js %}
		<script defer src="/js/pages/{{ js }}?{{ pkg.version }}"></script>
	{% endif %}
	{% if speedlify[canonical] %}
		<script defer src="/js/speedlify-score.js"></script>
	{% endif %}

	{% if category == 'code' or codepen %}
		<!-- CodePen Embeds -->
		<script defer src="https://codepen.io/assets/embed/ei.js"></script>
	{% endif %}

	{%- set in_reply_to_url = in_reply_to.url | default(in_reply_to) -%}
	{% if twitter or (in_reply_to_url.length and in_reply_to_url.includes('twitter.com')) %}
		<!-- Twitter Cards -->
		<script defer src="https://platform.twitter.com/widgets.js"></script>
	{% endif %}

	{% if speakerdeck or speakerdeck_slug %}
		<!-- Speaker Deck Embeds -->
		<script defer src="https://speakerdeck.com/assets/embed.js"></script>
	{% endif %}
</body>
</html>
